/** MIT License
* 
* Copyright (c) 2018 Ludovic CLUBER 
* 
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*
* http://triumphjs.lcluber.com
*/

var Triumph=function(t){"use strict";function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=[{id:1,name:"info"},{id:2,name:"trace"},{id:3,name:"warn"},{id:4,name:"error"},{id:99,name:"off"}],o=function(){function t(t,e){this.setLevel(t),this.content=e}var e=t.prototype;return e.setLevel=function(t){this.level=this.findLevel(t)},e.getLevelId=function(){return this.level.id},e.display=function(){},e.findLevel=function(t){for(var e=0;e<s.length;e++){var i=s[e];if(i.name===t)return i}return this.level?this.level:s[0]},t}(),a=function(){function n(){}var t,e,i;return n.info=function(t){n.log("info",t)},n.trace=function(t){n.log("trace",t)},n.time=function(t){n.log("time",t)},n.warn=function(t){n.log("warn",t)},n.error=function(t){n.log("error",t)},n.log=function(t,e){n.addMessage(t,e);var i=this.messages[this.nbMessages-1];this._level.id<=i.getLevelId()&&i.display()},n.addMessage=function(t,e){this.messages.push(new o(t,e)),this.nbMessages++},n.findLevel=function(t){for(var e=0;e<s.length;e++){var i=s[e];if(i.name===t)return i}return this._level?this._level:s[0]},t=n,(e=[{key:"level",set:function(t){n._level=n.findLevel(t)},get:function(){return n._level.name}}])&&r(t.prototype,e),i&&r(t,i),n}();a._level=a.findLevel(s[0].name),a.messages=[],a.nbMessages=0,a.target=document.getElementById("Mouette");var u=function(){function t(t,e,i,n,r,s,o){this.name=t,this.title=e,this.description=i,this.children=r||new h,this.value=r?0:n,this.date=0,this.image=s,this.reward=o}var e=t.prototype;return e.isActive=function(){return!!this.date},e.activate=function(t){return this.date=t||Date.now(),this.reward&&this.reward.activate(this.date),this.children.score.points||1},e.try=function(t,e){if(!this.isActive())if(this.children.length()){var i=this.children.score.points,n=this.children.try(null,t,e);if(100===this.children.progress)return{message:n,points:this.activate(e)};if(this.children.score.points>i)return{message:n,points:this.children.score.points-i}}else if(this.value<=t)return{message:this.title,points:this.activate(e)};return null},e.export=function(t){return t=t||this.name,this.children.length()?this.children.export(t):!!this.isActive()&&[{name:t,value:this.value,date:this.date}]},t}(),i=function(){function t(){this.points=0,this.total=0}var e=t.prototype;return e.getProgress=function(){return Math.floor(this.points/this.total*100)},e.updateProgress=function(t){return this.points+=t,this.getProgress()},t}(),h=function(){function t(){this.list=[],this.progress=0,this.score=new i}var e=t.prototype;return e.add=function(t,e,i,n,r,s,o){return this.get(t)?(a.warn("Achievement name already exists."),!1):(this.list.push(new u(t,e,i,n,r,s,o)),this.score.total++,r&&(this.score.total+=r.score.total),!0)},e.getPoints=function(){return this.score.points},e.getTotalPoints=function(){return this.score.total},e.get=function(e){return this.list.filter(function(t){return t.name===e}).shift()},e.length=function(){return this.list.length},e.try=function(t,e,i){var n=null;if(this.progress<100)if(t){var r=this.get(t);r&&(n=this.test(r,e,i))}else{var s=this.list,o=Array.isArray(s),a=0;for(s=o?s:s[Symbol.iterator]();;){var u;if(o){if(a>=s.length)break;u=s[a++]}else{if((a=s.next()).done)break;u=a.value}var h=u,l=this.test(h,e,i);l&&(n=l)}}return n},e.export=function(t){var e=[],i=this.list,n=Array.isArray(i),r=0;for(i=n?i:i[Symbol.iterator]();;){var s;if(n){if(r>=i.length)break;s=i[r++]}else{if((r=i.next()).done)break;s=r.value}var o=s.export(t);o&&e.push(o)}return!!e.length&&[].concat.apply([],e)},e.test=function(t,e,i){var n=t.try(e,i);return n&&n.points?(this.progress=this.score.updateProgress(n.points),n.message):null},t}(),l=function(){function t(t,e,i,n,r,s){this.name=t,this.title=e,this.description=i,this.amount=n,this.group=r,this.image=s,this.date=0}var e=t.prototype;return e.isActive=function(){return!!this.date},e.activate=function(t){return!this.isActive()&&(this.date=t,!0)},t}(),e=function(){function t(){this.list=[]}var e=t.prototype;return e.add=function(t,e,i,n,r,s){return this.getByName(t)?(a.warn("Reward name already exists."),!1):(this.list.push(new l(t,e,i,n,r,s)),!0)},e.getByGroups=function(){var t={},e=this.list,i=Array.isArray(e),n=0;for(e=i?e:e[Symbol.iterator]();;){var r;if(i){if(n>=e.length)break;r=e[n++]}else{if((n=e.next()).done)break;r=n.value}var s=r;t.hasOwnProperty(s.group)||(t[s.group]=[]),t[s.group].push(s)}return t},e.getByName=function(e){return this.list.filter(function(t){return t.name===e}).shift()},e.isActive=function(t){var e=this.getByName(t);return e&&e.isActive()?e:null},e.length=function(){return this.list.length},t}();return t.Achievements=h,t.Rewards=e,t}({});