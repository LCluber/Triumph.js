/** MIT License
* 
* Copyright (c) 2018 Ludovic CLUBER 
* 
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*
* http://triumphjs.lcluber.com
*/

var Triumph=function(t){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=[{id:1,name:"info"},{id:2,name:"trace"},{id:3,name:"warn"},{id:4,name:"error"},{id:99,name:"off"}],a=function(){function t(t,e){this.setLevel(t),this.content=e}var e=t.prototype;return e.setLevel=function(t){this.level=this.findLevel(t)},e.getLevelId=function(){return this.level.id},e.display=function(){},e.findLevel=function(t){for(var e=0;e<s.length;e++){var i=s[e];if(i.name===t)return i}return this.level?this.level:s[0]},t}(),o=function(){function r(){}var t,e,i;return r.info=function(t){r.log("info",t)},r.trace=function(t){r.log("trace",t)},r.time=function(t){r.log("time",t)},r.warn=function(t){r.log("warn",t)},r.error=function(t){r.log("error",t)},r.log=function(t,e){r.addMessage(t,e);var i=this.messages[this.nbMessages-1];this._level.id<=i.getLevelId()&&i.display()},r.addMessage=function(t,e){this.messages.push(new a(t,e)),this.nbMessages++},r.findLevel=function(t){for(var e=0;e<s.length;e++){var i=s[e];if(i.name===t)return i}return this._level?this._level:s[0]},t=r,(e=[{key:"level",set:function(t){r._level=r.findLevel(t)},get:function(){return r._level.name}}])&&n(t.prototype,e),i&&n(t,i),r}();o._level=o.findLevel(s[0].name),o.messages=[],o.nbMessages=0,o.target=document.getElementById("Mouette");var h=function(){function t(t,e,i,r,n,s,a){this.name=t,this.title=e,this.description=i,this.children=n||new l,this.value=n?0:r,this.date=0,this.image=s,this.reward=a}var e=t.prototype;return e.isActive=function(){return!!this.date},e.activate=function(t){return this.date=t||Date.now(),this.reward&&this.reward.activate(this.date),this.children.score.points||1},e.try=function(t,e){if(!this.isActive())if(this.children.length()){var i=this.children.score.points;if(this.children.try(null,t,e),100===this.children.progress)return this.activate(e);if(this.children.score.points>i)return this.children.score.points-i}else if(this.value<=t)return this.activate(e);return 0},e.export=function(t){return t=t||this.name,this.children.length()?this.children.export(t):!!this.isActive()&&[{name:t,value:this.value,date:this.date}]},t}(),i=function(){function t(){this.points=0,this.total=0}var e=t.prototype;return e.getProgress=function(){return Math.floor(this.points/this.total*100)},e.updateProgress=function(t){return this.points+=t,this.getProgress()},t}(),l=function(){function t(){this.list=[],this.progress=0,this.score=new i}var e=t.prototype;return e.add=function(t,e,i,r,n,s,a){return this.get(t)?(o.warn("Achievement name already exists."),!1):(this.list.push(new h(t,e,i,r,n,s,a)),this.score.total++,n&&(this.score.total+=n.score.total),!0)},e.getPoints=function(){return this.score.points},e.getTotalPoints=function(){return this.score.total},e.get=function(t){var e=this.list,i=Array.isArray(e),r=0;for(e=i?e:e[Symbol.iterator]();;){var n;if(i){if(r>=e.length)break;n=e[r++]}else{if((r=e.next()).done)break;n=r.value}var s=n;if(s.name===t)return s}return!1},e.length=function(){return this.list.length},e.try=function(t,e,i){if(this.progress<100)if(t){var r=this.get(t);r&&this.test(r,e,i)}else{var n=this.list,s=Array.isArray(n),a=0;for(n=s?n:n[Symbol.iterator]();;){var o;if(s){if(a>=n.length)break;o=n[a++]}else{if((a=n.next()).done)break;o=a.value}var h=o;this.test(h,e,i)}}},e.export=function(t){var e=[],i=this.list,r=Array.isArray(i),n=0;for(i=r?i:i[Symbol.iterator]();;){var s;if(r){if(n>=i.length)break;s=i[n++]}else{if((n=i.next()).done)break;s=n.value}var a=s.export(t);a&&e.push(a)}return!!e.length&&[].concat.apply([],e)},e.test=function(t,e,i){var r=t.try(e,i);return!!r&&(this.progress=this.score.updateProgress(r),!0)},t}(),u=function(){function t(t,e,i,r){this.name=t,this.title=e,this.description=i,this.image=r,this.date=0}var e=t.prototype;return e.isActive=function(){return!!this.date},e.activate=function(t){return!this.isActive()&&(this.date=t,!0)},t}(),e=function(){function t(){this.list=[]}var e=t.prototype;return e.add=function(t,e,i,r){return this.get(t)?(o.warn("Reward name already exists."),!1):(this.list.push(new u(t,e,i,r)),!0)},e.get=function(t){var e=this.list,i=Array.isArray(e),r=0;for(e=i?e:e[Symbol.iterator]();;){var n;if(i){if(r>=e.length)break;n=e[r++]}else{if((r=e.next()).done)break;n=r.value}var s=n;if(s.name===t)return s}return!1},e.length=function(){return this.list.length},t}();return t.Achievements=l,t.Rewards=e,t}({});